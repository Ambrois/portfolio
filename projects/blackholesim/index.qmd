---
title: "Black Hole Simulation"
date: 2025-11-25
image: recent_screenshot.png
description: "Schwarzschild black hole raymarcher from scratch using C++, SFML, and GLSL."
categories: ["computer-graphics", "physics"]
---
## Introduction

This project is a real-time black hole visualization engine built from scratch in C++, using GPU shaders for parallel computation. The goal was to simulate how light bends near a black hole and render the resulting image on screen, while simultaneously modern C++, graphics programming, and numerical simulation techniques.

At a high level, the program treats each screen pixel as a ray of light emitted from a virtual camera. These rays are numerically simulated as they travel through curved spacetime near a black hole. Depending on how each ray bends and what it intersects (background stars or an accretion disk), the program computes the final color of that pixel. The entire process runs in parallel on the GPU, allowing thousands of light paths to be simulated simultaneously.

This project required building multiple systems end-to-end:

- A custom ray-marching pipeline implemented in GLSL
- A numerical solver (fourth-order Rungeâ€“Kutta with adaptive step size) for physically motivated differential equations
- A rendering pipeline integrating C++, SFML, and shaders
- Performance optimizations and debugging in a GPU-only environment

Although the underlying physics is based on general relativity, the primary focus of the project was systems design, numerical methods, and performance-conscious implementation, rather than producing a scientifically exact model. This was my first C++ and graphics project, and it served as a practical way to learn lower-level programming, GPU parallelism, and how complex simulations are built and debugged in practice.

[View Repository](https://github.com/Ambrois/Black-Hole-Sim)

## Screenshots

![Most Recent Screenshot](screenshots/2025-11-22.png)
![Most Recent Screenshot](screenshots/2025-11-25.png)

- Added background stars
- Made disk color more realistic: calculate temperature -> approximate black body radiation -> color
- More realistic disk sizing, note that the photon ring is now visible! I'm not sure what that very thin ring inside the photon ring is, and it might be a bug, but that's for future me to figure out.

***
![Older Screenshot](screenshots/2025-11-17.png)
- Added adaptive step sizing and other optimizations
- Fixed object edge rendering for arbitrary step size
- Added prettier colors and a grid to see how spacetime curves, and it's very clearly showing gravitational lensing

***
![Older Screenshot](screenshots/2025-11-15.png)

- Implementing RK4 for the null geodesic equations in 3D.
- Parallelized everything via fragment shader, which was quite difficult, as debugging information could only be encoded through pixel color. I've since learned that I should have used a compute shader and passed to a simple fragment shader, which would have been easier to debug and manage.

***
![Older Screenshot](screenshots/2025-11-04.png)

- Derived the null geodesic equations in 2D via Lagrangian, here I learned the basics of general relativity.
- Implemented RK4 for numerically solving said equations.

***
![Older Screenshot](screenshots/2025-10-21.png)

- Built basic euclidean raymarching engine. 
- More of learning how to program in C++.

***
![Older Screenshot](screenshots/2025-10-18.png)

- Drew a circle!
- Learned the very basics of C++, SFML, and GLSL.

***

## Future work:
- A more detailed writeup of the equation derivations and algorithm details is in process.
- The center of the bh has trouble rendering bc parameterizing with phi, I'll try to minimize this by adjusting the dynamic step size to account for starting angle
- If you move, the camera turns slightly on its own, because I've yet to implement parallel transport of the camera directions, but this is in progress.
- Accretion disk adjustments:
  - Could use better boundary detection.
  - Its shape should be flared out a little for more realism.
  - Could add doppler effect coloring.
